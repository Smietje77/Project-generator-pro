---
---

<div x-show="activeTab === 'overview'" x-cloak class="space-y-6">
  <!-- Project Summary Card -->
  <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-6">
    <h3 class="text-lg font-semibold text-blue-900 mb-4 flex items-center gap-2">
      <span class="text-2xl">ðŸ“‹</span>
      Project Summary
    </h3>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
      <div>
        <div class="text-blue-700 font-medium">Project Type</div>
        <div id="overview-project-type" class="text-blue-900 font-semibold">-</div>
      </div>
      <div>
        <div class="text-blue-700 font-medium">Complexity</div>
        <div id="overview-complexity" class="text-blue-900 font-semibold">-</div>
      </div>
      <div>
        <div class="text-blue-700 font-medium">Duration</div>
        <div id="overview-duration" class="text-blue-900 font-semibold">-</div>
      </div>
      <div>
        <div class="text-blue-700 font-medium">Team Size</div>
        <div id="overview-team-size" class="text-blue-900 font-semibold">-</div>
      </div>
    </div>
  </div>

  <!-- Recommended MCPs -->
  <div class="space-y-4">
    <div class="flex items-center justify-between">
      <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
        <span class="text-xl">ðŸ”§</span>
        Recommended MCP Servers
      </h3>
      <span id="mcp-count" class="text-sm text-gray-500">- MCPs</span>
    </div>
    <div id="mcp-list" class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <!-- Will be populated dynamically -->
    </div>
  </div>

  <!-- AI Agents -->
  <div class="space-y-4">
    <div class="flex items-center justify-between">
      <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
        <span class="text-xl">ðŸ¤–</span>
        AI Agents
      </h3>
      <span id="agents-count" class="text-sm text-gray-500">- Agents</span>
    </div>
    <div id="agents-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- Will be populated dynamically -->
    </div>
  </div>

  <!-- Task Breakdown -->
  <div class="space-y-4">
    <div class="flex items-center justify-between">
      <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
        <span class="text-xl">ðŸ“Š</span>
        Task Breakdown
      </h3>
      <span id="tasks-count" class="text-sm text-gray-500">- Tasks</span>
    </div>
    <div id="tasks-list" class="bg-gray-50 border border-gray-200 rounded-lg p-4 max-h-80 overflow-y-auto">
      <!-- Will be populated dynamically -->
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="grid grid-cols-3 gap-4">
    <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
      <div class="text-3xl font-bold text-green-900" id="stat-total-hours">-</div>
      <div class="text-sm text-green-700 mt-1">Estimated Hours</div>
    </div>
    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
      <div class="text-3xl font-bold text-purple-900" id="stat-total-phases">-</div>
      <div class="text-sm text-purple-700 mt-1">Development Phases</div>
    </div>
    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 text-center">
      <div class="text-3xl font-bold text-orange-900" id="stat-total-features">-</div>
      <div class="text-sm text-orange-700 mt-1">Features</div>
    </div>
  </div>
</div>

<style>
  [x-cloak] {
    display: none !important;
  }
</style>

<script>
  // Overview tab data population
  window.addEventListener('step3:analysis-ready', ((event: CustomEvent) => {
    const { analysis, config } = event.detail;

    // Update project summary
    document.getElementById('overview-project-type')!.textContent = config.type || '-';
    document.getElementById('overview-complexity')!.textContent = config.metadata?.estimatedComplexity || 'moderate';
    document.getElementById('overview-duration')!.textContent = config.metadata?.estimatedDuration || '-';
    document.getElementById('overview-team-size')!.textContent = `${config.metadata?.teamSize || analysis.requiredAgents?.length || '-'} Agents`;

    // Display MCPs
    const mcpList = document.getElementById('mcp-list');
    const mcpCount = document.getElementById('mcp-count');

    if (mcpList && analysis.recommendedMCPs) {
      mcpCount!.textContent = `${analysis.recommendedMCPs.length} MCPs`;

      mcpList.innerHTML = analysis.recommendedMCPs.map((mcp: any) => `
        <div class="flex items-start gap-3 p-4 bg-white border-2 border-indigo-200 rounded-lg hover:border-indigo-400 transition-colors">
          <div class="flex-shrink-0 w-10 h-10 bg-indigo-600 text-white rounded-lg flex items-center justify-center font-semibold text-lg">
            ${mcp.name.charAt(0).toUpperCase()}
          </div>
          <div class="flex-1 min-w-0">
            <h4 class="font-semibold text-gray-900 truncate">${mcp.name}</h4>
            <p class="text-sm text-gray-600 mt-1 line-clamp-2">${mcp.description || 'No description available'}</p>
            ${mcp.required ? '<span class="inline-block mt-2 px-2 py-1 bg-indigo-100 text-indigo-800 text-xs font-medium rounded">Required</span>' : ''}
          </div>
        </div>
      `).join('');
    }

    // Display Agents
    const agentsList = document.getElementById('agents-list');
    const agentsCount = document.getElementById('agents-count');

    if (agentsList && analysis.requiredAgents) {
      agentsCount!.textContent = `${analysis.requiredAgents.length} Agents`;

      agentsList.innerHTML = analysis.requiredAgents.map((agent: any) => {
        const priorityColors: Record<string, string> = {
          critical: 'bg-red-100 text-red-800 border-red-300',
          high: 'bg-orange-100 text-orange-800 border-orange-300',
          medium: 'bg-yellow-100 text-yellow-800 border-yellow-300',
          low: 'bg-green-100 text-green-800 border-green-300'
        };

        const priorityClass = priorityColors[agent.priority] || priorityColors.medium;

        return `
        <div class="p-4 bg-white border-2 ${priorityClass} rounded-lg hover:shadow-md transition-shadow">
          <div class="flex items-start justify-between mb-2">
            <h4 class="font-semibold text-gray-900">${agent.name}</h4>
            <span class="text-xs font-medium px-2 py-1 rounded ${priorityClass}">${agent.priority}</span>
          </div>
          <p class="text-sm text-gray-600 mb-3">${agent.role}</p>
          <div class="flex flex-wrap gap-1">
            ${(agent.mcpAccess || []).slice(0, 3).map((mcp: string) => `
              <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded font-medium">${mcp}</span>
            `).join('')}
            ${agent.mcpAccess?.length > 3 ? `<span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded">+${agent.mcpAccess.length - 3}</span>` : ''}
          </div>
        </div>`;
      }).join('');
    }

    // Display Tasks
    const tasksList = document.getElementById('tasks-list');
    const tasksCount = document.getElementById('tasks-count');

    if (tasksList && analysis.taskBreakdown) {
      tasksCount!.textContent = `${analysis.taskBreakdown.length} Tasks`;

      tasksList.innerHTML = `
        <ul class="space-y-2">
          ${analysis.taskBreakdown.map((task: any, index: number) => `
            <li class="flex items-start gap-3 p-2 hover:bg-gray-100 rounded transition-colors">
              <span class="flex-shrink-0 w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold">${index + 1}</span>
              <div class="flex-1">
                <div class="text-sm font-medium text-gray-900">${task.title || task.description || task}</div>
                ${task.agent ? `<div class="text-xs text-gray-500 mt-1">Assigned to: ${task.agent}</div>` : ''}
                ${task.estimatedHours ? `<div class="text-xs text-gray-500">Est: ${task.estimatedHours}h</div>` : ''}
              </div>
            </li>
          `).join('')}
        </ul>
      `;
    }

    // Update stats
    const totalHours = analysis.taskBreakdown?.reduce((sum: number, task: any) =>
      sum + (task.estimatedHours || 0), 0) || 0;

    document.getElementById('stat-total-hours')!.textContent = totalHours > 0 ? totalHours.toString() : '-';
    document.getElementById('stat-total-phases')!.textContent = '4'; // Foundation, Development, Testing, Deployment
    document.getElementById('stat-total-features')!.textContent = config.features?.length?.toString() || '-';

  }) as EventListener);
</script>
